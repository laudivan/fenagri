siteSwiper=false;function bigeyesInit(){if(isDevice()){window.setTimeout(function(){navigator.splashscreen.hide()},3000);document.addEventListener("deviceready",onDeviceReady,false)}else{$(window).load(onBrowserReady())}$(window).bind("pageshow resize orientationchange",function(b){if($("#sites").hasClass("ui-page-active")){refreshImgListviewSize()}else{if($("#site-map").hasClass("ui-page-active")){resizeMap()}}})}siteDescription=false;categoryId=false;function showSiteDescription(b){var e=BaseApiURL+"/whitelabel/"+WhitelabelId+"/site/"+b;$("#site-description-content").empty();logoCanv=$(document).width()*0.8;$("#site-description-content").append('<center><img id="site-logo" src="'+e+"/thumb/"+logoCanv+'/logo"></center>');$.getJSON(e,function(f){if(f!==null){localStorage["site:"+b]=JSON.stringify(f)}else{f=JSON.parse(localStorage["site:"+b])}siteDescription=f;$("#site-description-content").append('<h3 id="site-name">'+f.title+"</h3><hr>");buttonBar='<div class="ui-body">';if(f.phone!==""){buttonBar+='<a href="tel:'+f.phone+'" id="site-phone">'+f.phone+"</a>"}if(mapApiIsLoaded()&&CategoryWithoutMap.indexOf(categoryId)<0){buttonBar+='<a onclick="createMap()" id="btn-see-on-map" class="btn-show">';buttonBar+='<img src="style/images/icons/see-on-map.png" alt="Ver no mapa"></a>'}if(f.has_offers==="1"){buttonBar+='<a onclick="showOffersForSite('+b+')" id="btn-show-itens" class="btn-show">';buttonBar+='<img src="style/images/icons/itens-list.png" alt="Lista de itens"></a>'}buttonBar+="</div>";$("#site-description-content").append(buttonBar);description='<div  class="ui-body ui-body-c">';description+="<p>"+f.description+"</p>";if(f.address){description+="<hr>";description+="<p>"+f.address+"</p>"}description+="</div>";$("#site-description-content").append(description);$.getJSON(e+"/media",function(h){if(h.length===0||(h.length===1&&h[0]["site_logo"]==="1")){return}photos='<br><div id="photos">';photos+='<div class="ui-body ui-body-c">';photos+='<div class="swiper-container">';photos+='<div class="swiper-wrapper">';$.each(h,function(i,j){if(j.site_logo==="0"){photos+='<div class="swiper-slide"><img src="'+e+"/thumb/400/media/"+j.id+'" alt=""></div>'}});photos+="</div></div></div></div>";$("#site-description-content").append(photos);var g=new Swiper(".swiper-container",{mode:"horizontal",loop:false,speed:1000,calculateHeight:true,autoResize:true,slidesPerView:1,autoplay:1000})})});$.mobile.changePage("#site-description",{transition:"slide"});siteVisit()}function showOffersForSite(e){offersURL=BaseApiURL+"/whitelabel/"+WhitelabelId+"/site/"+e+"/offer";var b=[];$("#site-itens").panel("open");$("#site-itens ul").empty();$.getJSON(offersURL,function(f){if(f!==null){localStorage["offer:"+e]=JSON.stringify(f)}else{f=JSON.parse(localStorage["offer:"+e])}$.each(f,function(g,h){$("#site-itens ul").append("<li><a><h2>"+h.title+"</h2><p>"+h.description+"</p><p>"+h.monetary+""+h.value+"</p></a></li>")})});$("#site-itens ul").listview("refresh")}function showSitesByCategory(e){if(!isConnected()){switch(e){case 1:msg="Você precisa de uma conexão de dados para ter acesso aos pontos turísticos.";break;case 2:msg="Nossas informações sobre hotéis estão todas na Internet. Por favor, conecte-se e tente novamente.";break;case 3:msg="Estando conectado(a) a Internet você terá acesso à lista atualizada de nossos melhores restaurantes.";break;case 4:msg="Utilize uma conexão de dados ou Wi-Fi para conhecer os melhores bares da região.";break;case 7:msg="Precisando de um taxi? Conecte-se e escolha um dentre os melhores serviços da região.";break}navigator.notification.alert(msg,function(){},"Conexão requerida","OK");backToHome();return}mapApiLoad();categoryId=e;var b=BaseApiURL+"/whitelabel/"+WhitelabelId+"/category/"+categoryId+"/site";$.getJSON(b,function(g){var f=[];if(g!==null){localStorage["category:"+categoryId]=JSON.stringify(g)}else{g=JSON.parse(localStorage["category:"+categoryId])}$("#sites-ul").attr("data-category",categoryId);$.each(g,function(h,i){site_id=i.site_id;title=i.title;description=i.description;thumbSize=$(document).width()<480?130:$(document).width()<600?200:$(document).width()<800?250:300;f.push('<li data-site="'+site_id+'"><a onclick="showSiteDescription('+site_id+')"><img src="'+b+"/"+site_id+"/thumb/"+thumbSize+'/logo" class="ui-li-thumb" alt="'+title+'"><h2>'+title+"</h2>")});$("#sites-ul").html(f.join(""));$("#sites-ul").listview("refresh")});$.mobile.changePage("#sites",{transition:"slide"});categoryVisit(categoryId)}function backToHome(){$.mobile.changePage("#home",{transition:"slide"});$("#site-description-content").empty();$("#sites-ul").empty();if(mapObj){$("#map-canvas").gmap("destroy");mapObj=false}}function backSitesToHome(){window.history.back();$("#sites-ul").empty()}function backToSiteList(){window.history.back();$("#site-description-content").empty()}mapObj=false;firstLoad=true;siteMarker=false;clientMarker=false;latLngBound=false;directions=false;mapApiLoaded=false;function createMap(){$.mobile.changePage("#site-map",{transition:"slide"});if(siteDescription.latitude){siteLat=siteDescription.latitude;siteLog=siteDescription.longitude}else{siteLat=DefaultMapLat;siteLog=DefaultMapLon}siteLocation=new google.maps.LatLng(siteLat,siteLog);mapOptions={zoom:13,backgroundColor:"#26262d",center:siteLocation,mapTypeId:google.maps.MapTypeId.ROADMAP,zoomControl:false,scrollwheel:false,disableDoubleClickZoom:false,streetViewControl:false,overviewMapControl:false,panControl:false,scaleControl:false,mapTypeControl:true,disableDefaultUI:false,maxZoom:19,minZoom:8};mapObj=new google.maps.Map(document.getElementById("map-canvas"),mapOptions);siteMarker=new google.maps.Marker({position:siteLocation,map:mapObj,title:siteDescription.title,animation:google.maps.Animation.DROP,icon:"style/images/icons/site-location.png"});if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(b){clientPosition=new google.maps.LatLng(b.coords.latitude,b.coords.longitude);clientMarker=new google.maps.Marker({position:clientPosition,map:mapObj,title:"Você está aqui.",animation:google.maps.Animation.DROP,icon:"style/images/icons/user-location.png"});latLngBound=new google.maps.LatLngBounds();latLngBound.extend(siteMarker.getPosition());latLngBound.extend(clientMarker.getPosition());mapObj.fitBounds(latLngBound);mapObj.panTo(latLngBound.getCenter());mapObj.panToBounds(latLngBound)})}}function backFromMapToHome(){if(clientMarker){clientMarker.setMap(null)}if(siteMarker){siteMarker.setMap(null)}clientMarker=false;siteMarker=false;latLngBound=false;directions=false;mapObj=false;firstLoad=true;$("#map-canvas").empty();$.mobile.changePage("#home",{transition:"slide"})}function backFromMapToDesc(){window.history.back();if(clientMarker){clientMarker.setMap(null)}if(siteMarker){siteMarker.setMap(null)}clientMarker=false;siteMarker=false;latLngBound=false;directions=false;firstLoad=true;mapObj=false;$("#map-canvas").empty()}function getDistanceFromLatLonInKm(g,e,f,b){R=6371;dLat=deg2rad(f-g);dLon=deg2rad(b-e);a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(deg2rad(g))*Math.cos(deg2rad(f))*Math.sin(dLon/2)*Math.sin(dLon/2);c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));d=R*c;return d}function deg2rad(b){return b*(Math.PI/180)}function refreshImgListviewSize(){categoryId=$("#sites-ul").attr("data-category");thumbSize=$(document).width()<480?130:$(document).width()<600?200:$(document).width()<800?250:300;baseUrl=BaseApiURL+"/whitelabel/"+WhitelabelId+"/category/"+categoryId+"/site/";listItens=$("#sites-ul").children();$.each(listItens,function(b,e){siteId=$(this).attr("data-site");$(this).children("img").attr("src",baseUrl+siteId+"?thumb="+thumbSize)});$("#sites-ul").listview("refresh")}function onDeviceReady(){BaseDeviceUrl=BaseApiURL+"whitelabel"+WhitelabelId+"/device/"+device.uuid;if(localStorage.getItem("apikey")){ApiKey=localStorage.getItem("apikey")}else{}$("#front-page-header").toolbar("hide");switch(device.platform){case"Win32NT":$(".copyright").removeClass("ui-footer-fixed");$(".copyright").removeClass("ui-footer-fullscreen");$(".copyright").addClass("copyright-wp8");storeName="Windows Phone Store";storeLink="http://www.windowsphone.com/pt-br/store";break;case"Android":storeName="Google Play Store";storeLink="https://play.google.com/store";break;case"iOS":storeName="Apple Store";storeLink="http://www.apple.com/";break;case"BlackBerry 10":storeName="App World";storeLink="href","https://appworld.blackberry.com";break}$(document).scroll(function(){if(!$("#home").is(":visible")){return}if($("#front-page-header").hasClass("ui-fixed-hidden")&&$(document).scrollTop()>150){$("#front-page-header").toolbar("show");$("#front-page-header").toolbar("refresh")}else{if($(document).scrollTop()<50){$("#front-page-header").toolbar("hide")}}});if(localStorage.getItem("BECount")){count=parseInt(localStorage.getItem("BECount"));if(count!==-1){localStorage.setItem("BECount",count+1)}}else{localStorage.setItem("BECount",1)}if(localStorage.getItem("BECount")==="5"){navigator.notification.confirm("Está gostando do aplicativo da FENAGRI? Então vá a "+storeName+" e mostre a sua opnião.",function(b){if(b===1){localStorage.setItem("BECount",-1);window.open(storeLink,"_blank")}else{if(b===2){localStorage.setItem("BECount",0)}else{localStorage.setItem("BECount",0)}}},"Mostre-nos a sua opnião sobre o aplicativo",["Vamos lá!","Depois.","Nunca.",""])}}function onBrowserReady(){$("#front-page-header").toolbar("hide");$(document).scroll(function(){if(!$("#home").is(":visible")){return}if($("#front-page-header").hasClass("ui-fixed-hidden")&&$(document).scrollTop()>150){$("#front-page-header").toolbar("show");$("#front-page-header").toolbar("refresh")}else{if($(document).scrollTop()<50){$("#front-page-header").toolbar("hide")}}})}function isConnected(){if(!isDevice()){return window.navigator.onLine}return navigator.connection.type!==Connection.NONE}function mapApiIsLoaded(){return mapApiLoaded}function checkIn(){}function categoryVisit(b){}function siteVisit(b){}function voteOnSite(){}function loading(e,b){if(b){$(e+" .loading").removeClass("loading-hide")}else{if(!$(e+" .loading").hasClass("loading-hide")){$(".loading").addClass("loading-hide")}}}function resizeMap(){if(!isDevice()){$(".gm-style").height($("body").height());$("#map-canvas").height($("body").height())}else{$(".gm-style").height($(window).height());$("#map-canvas").height($(window).height())}}function mapApiLoad(){url="https://maps.googleapis.com/maps/api/js?sensor=true&callback=mapinitialize&key="+MapKey;if(mapApiIsLoaded()){return}$.getScript(url,function(){mapApiLoaded=true});mapApiLoaded=true}function mapinitialize(){mapApiLoaded=true}function isDevice(){return true};